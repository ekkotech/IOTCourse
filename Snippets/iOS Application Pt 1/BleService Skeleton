/*** Snippets for iOS Application Part 1, BleService Skeleton ***/

/*** Insert a file level ***/
/*** BleService_Skeleton_Snip_1 ***/
import CoreBluetooth
import os


// MARK: - BleService class
//
internal final class BleService: NSObject {
    
    override init() {
        super.init()
        //
    }
    
}

/*** End ***/

/*** Insert into BleService class properties ***/
/*** BleService_Skeleton_Snip_2 ***/
private var centralManager: CBCentralManager?
private let initOptions = [CBCentralManagerOptionShowPowerAlertKey : NSNumber(value: true)]

/*** End ***/

/*** Insert into BleService class initialiser ***/
/*** BleService_Skeleton_Snip_3 ***/
centralManager = CBCentralManager(delegate: self,
                                  queue: DispatchQueue(label: "com.iotcourse.bleq",
                                                       qos: .userInitiated),
                                  options: initOptions)


/*** End ***/

/*** Insert after BleService class ***/
/*** BleService_Skeleton_Snip_4 ***/
// MARK: - CBCentralManager delegate
//
extension BleService: CBCentralManagerDelegate {
    public func centralManagerDidUpdateState(_ central: CBCentralManager) {
        //
    }
}

// MARK: - CBPeripheralDelegate
//
extension BleService: CBPeripheralDelegate {
    //
}

/*** End ***/

/*** Insert into CBCentralManagerDelegate didUpdateState ***/
/*** BleService_Skeleton_Snip_5 ***/
os_log("Central Manager state: %s", log: Log.ble, type: .info, central.state.description)

/*** End ***/

/*** Insert at end of BleService class ***/
/*** BleService_Skeleton_Snip_6 ***/
// MARK: - Public (Internal) API
//
func attachPeripheral(service: CBUUID) {
    //
}

func read(service: CBUUID, charac: CBUUID) {
    //
}

func write(service: CBUUID, charac: CBUUID, data: Data, response: Bool) {
    //
}

func setNotify(service: CBUUID, charac: CBUUID, state: Bool) {
    //
}

func readRssi() {
    //
}

/*** End ***/
